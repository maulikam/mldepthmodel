<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Depth Estimation</title>
</head>
<body>
   <h1>Depth Estimation</h1>
   <input type="file" id="fileInput">
   <input type="number" id="knownDistance" placeholder="Known Distance (meters)">
   <input type="text" id="refPoint1" placeholder="Reference Point 1 (x,y)">
   <input type="text" id="refPoint2" placeholder="Reference Point 2 (x,y)">
   <button onclick="uploadImage()">Upload and Process</button>
   <div id="result"></div>
   <script>
       async function uploadImage() {
           const fileInput = document.getElementById('fileInput');
           const knownDistance = document.getElementById('knownDistance').value;
           const refPoint1 = document.getElementById('refPoint1').value.split(',').map(Number);
           const refPoint2 = document.getElementById('refPoint2').value.split(',').map(Number);

           if (fileInput.files.length === 0 || !knownDistance || refPoint1.length !== 2 || refPoint2.length !== 2) {
               alert('Please provide all inputs');
               return;
           }

           const formData = new FormData();
           formData.append('file', fileInput.files[0]);

           const data = {
               ref_points: [refPoint1, refPoint2],
               known_distance_meters: parseFloat(knownDistance)
           };

           const response = await fetch('https://0095-2401-4900-791b-5e47-7123-fa11-236e-8e56.ngrok-free.app/upload', {
               method: 'POST',
               body: formData,
               headers: {
                   'Accept': 'application/json'
               }
           });

           const blob = await response.blob();
           const url = URL.createObjectURL(blob);

           document.getElementById('result').innerHTML = `<img src="${url}" alt="Depth Map">`;
       }
   </script>
</body>
</html>
